<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Doctor Profile</title>
  </head>
  <body>

    <h1>Welcome Doctor</h1>
    <h2>List of Patients</h2>
    <ul id="patient_list">

    </ul>
    <p>click here to sign out</p>
    <button id="signout_btn">Sign Out</button>
    <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-firestore.js"></script>
    <script type="text/javascript">
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "AIzaSyCIrRQLlsAzssCKjevk9AwFloPLrWSCfHk",
        authDomain: "mediscreen-674eb.firebaseapp.com",
        databaseURL: "https://mediscreen-674eb.firebaseio.com",
        projectId: "mediscreen-674eb",
        storageBucket: "mediscreen-674eb.appspot.com",
        messagingSenderId: "292545820886",
        appId: "1:292545820886:web:9fe5753b475a2f524b3177",
        measurementId: "G-FCP7TQ40TP"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      const signoutbut = document.getElementById('signout_btn');
      const auth = firebase.auth();
      const db = firebase.firestore();

      db.collection('patients').get().then(snapshot =>{
        //console.log(snapshot.docs);
        outputPatients(snapshot.docs);
      })
      //Signs user out
      signoutbut.addEventListener('click', e => {
        firebase.auth().signOut();

      });
      //Detects if the user is signed in or not
      firebase.auth().onAuthStateChanged(fireBaseUser => {
        if(fireBaseUser){
          console.log(fireBaseUser);
          //If the user is signed in, make the signout button visible
          signoutbut.style.display = "block";
        }else{
          console.log('not logged in');
          signoutbut.style.display = "none";
          //Redirect user to the main log in page when they log out
          window.location = 'doctor.html';
        }
      });
    </script>
    <script src="auth.js"></script>
  </body>
</html>
